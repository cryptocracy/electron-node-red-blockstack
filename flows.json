[{"id":"b14d8661.cf75a8","type":"tab","label":"My .ID","disabled":false,"info":""},{"id":"1cff0692.475319","type":"tab","label":"Search ID","disabled":false,"info":""},{"id":"6749a743.2cf198","type":"tab","label":"Search Projects","disabled":false,"info":""},{"id":"36c46629.c8f23a","type":"tab","label":"Blockchain Stats","disabled":false,"info":""},{"id":"c13afb34.e0d258","type":"tab","label":"Encrypted Storage","disabled":false,"info":""},{"id":"67cf68d0.b19928","type":"ui_group","z":"","name":"Results","tab":"3f3f3d56.0c7d72","disp":false,"width":"8","collapse":false},{"id":"c986165f.9bf6e8","type":"ui_group","z":"","name":"More Info","tab":"3f3f3d56.0c7d72","disp":false,"width":"8","collapse":false},{"id":"3f3f3d56.0c7d72","type":"ui_tab","z":"","name":"My ID","icon":"face","order":1},{"id":"137ba413.c8cd2c","type":"ui_base","theme":{"name":"theme-custom","lightTheme":{"default":"#0094CE","baseColor":"#451b5c","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#270f34","baseFont":"Georgia,Georgia,serif","edited":true,"reset":false},"customTheme":{"name":"Blockstack Theme","default":"#4B7930","baseColor":"#451b5c","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","reset":false},"themeState":{"base-color":{"default":"#4B7930","value":"#451b5c","edited":true},"page-titlebar-backgroundColor":{"value":"#8936b6","edited":true},"page-backgroundColor":{"value":"#ffffff","edited":true},"page-sidebar-backgroundColor":{"value":"#ab65d1","edited":true},"group-textColor":{"value":"#ffffff","edited":true},"group-borderColor":{"value":"#ffffff","edited":true},"group-backgroundColor":{"value":"#ffffff","edited":true},"widget-textColor":{"value":"#000000","edited":true},"widget-backgroundColor":{"value":"#8936b6","edited":true},"widget-borderColor":{"value":"#ffffff","edited":true},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}}},"site":{"name":"dApparatus","hideToolbar":"false","allowSwipe":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":84,"sy":50,"gx":3,"gy":3,"cx":2,"cy":2,"px":1,"py":1}}},{"id":"c4426ac2.c3f438","type":"ui_link","z":"","name":"Admin","link":"/admin","icon":"build","target":"newtab","order":8},{"id":"bbc9377.b25a9c8","type":"ui_link","z":"","name":"Search ID","link":"/searchid","icon":"search","target":"iframe","order":2},{"id":"a1b96b53.596838","type":"ui_tab","z":"","name":"ID Results","icon":"verified_user","order":3},{"id":"c245c49a.425238","type":"ui_group","z":"","name":"Results","tab":"a1b96b53.596838","order":1,"disp":true,"width":"8","collapse":false},{"id":"17b0efc1.2a542","type":"ui_link","z":"","name":"Search Project","link":"/searchproject","icon":"near_me","target":"iframe","order":4},{"id":"5493b0d1.0a15a","type":"ui_tab","z":"","name":"Project Results","icon":"map","order":5},{"id":"a266c3f6.4664","type":"ui_group","z":"","name":"Results","tab":"5493b0d1.0a15a","order":1,"disp":true,"width":"8","collapse":false},{"id":"9c3a8e49.22606","type":"ui_link","z":"","name":"Encrypted Todo","link":"/savedata","icon":"fa-key","target":"iframe","order":6},{"id":"58a70df8.e22b24","type":"ui_tab","z":"","name":"Saved Results","icon":"fa-list","order":7},{"id":"7435c557.fc056c","type":"JsonWebToken_config","z":"","name":"JWT","secret":"123abc"},{"id":"1dae6acc.6eaf65","type":"dropbox-config","z":"","name":"dApparatus DropBox"},{"id":"af25ae1a.1afe3","type":"inject","z":"b14d8661.cf75a8","name":"inject ","topic":"","payload":"","payloadType":"date","repeat":"30","crontab":"","once":true,"onceDelay":"0.1","x":70,"y":20,"wires":[["2f163f25.b60ba"]]},{"id":"9d569c14.93afb","type":"debug","z":"b14d8661.cf75a8","name":"","active":true,"console":"false","complete":"payload","x":450,"y":20,"wires":[]},{"id":"e49726c2.178bd8","type":"ui_template","z":"b14d8661.cf75a8","group":"67cf68d0.b19928","name":"Result","order":1,"width":"8","height":"7","format":"<md-card md-theme=\"\" md-theme-watch>\n<md-card-title>\n    <md-card-title-text>\n        <span class=\"md-headline\">{{msg.payload[0].decodedToken.payload.claim.name}}</span>\n    </md-card-title-text>\n</md-card-title>\n<md-card-content layout=\"row\" layout-align=\"space-between\">\n<div class=\"md-media-xl card-media\">\n   <img src=\"{{msg.payload[0].decodedToken.payload.claim.image[0].contentUrl}}\" alt=\"{{msg.payload[0].decodedToken.payload.claim.name}}\" width=\"180\" height=\"180\">\n    <md-card-title-text>\n        <p></p>\n        <span class=\"md-subhead\">{{msg.payload[0].decodedToken.payload.claim.description}}</span>\n    </md-card-title-text>\n</div>\n<md-card-actions layout=\"column\">\n<md-button class=\"fa fa-link fa-2x\" ng-href=\"{{msg.payload[0].decodedToken.payload.claim.account[0].proofUrl}}\" target=\"_blank\" aria-label=\"1st Proof\">\n  <md-icon ></md-icon>1st\n</md-button>\n<md-button class=\"fa fa-link fa-2x\" ng-href=\"{{msg.payload[0].decodedToken.payload.claim.account[1].proofUrl}}\" target=\"_blank\" aria-label=\"2nd Proof\">\n  <md-icon ></md-icon>2nd\n</md-button>\n<span class=\"md-subhead\"><img src=\"https://blockchain.info/qr?data={{msg.payload[0].decodedToken.payload.claim.account[0].identifier}}&size=200\" alt=\"QR\" height=\"125\" width=\"125\"></span>\n\n\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":1030,"y":280,"wires":[[]]},{"id":"3ca57739.6241f8","type":"http request","z":"b14d8661.cf75a8","name":"get from blockstack","method":"GET","ret":"txt","url":"https://core.blockstack.org/v1/names/{{payload}}","tls":"","x":170,"y":100,"wires":[["57f8f68e.bd31c8"]]},{"id":"57f8f68e.bd31c8","type":"json","z":"b14d8661.cf75a8","name":"","pretty":false,"x":350,"y":100,"wires":[["60d812c7.8080bc","2436b076.f0367"]]},{"id":"55b29b6f.e4eee4","type":"debug","z":"b14d8661.cf75a8","name":"","active":true,"console":"false","complete":"false","x":770,"y":140,"wires":[]},{"id":"60d812c7.8080bc","type":"function","z":"b14d8661.cf75a8","name":"rebind zonefile","func":"var raw_zone = msg.payload.zonefile;\n\nmsg.payload = raw_zone;\n\nreturn msg;","outputs":1,"noerr":0,"x":120,"y":200,"wires":[["45312be0.e19094"]]},{"id":"6bff35be.fe28ec","type":"http request","z":"b14d8661.cf75a8","name":"get from gaia","method":"GET","ret":"txt","url":"","tls":"","x":670,"y":240,"wires":[["c13c3ca0.7a3ec"]]},{"id":"c13c3ca0.7a3ec","type":"json","z":"b14d8661.cf75a8","name":"","pretty":false,"x":810,"y":240,"wires":[["e49726c2.178bd8","d5d09a3c.7502f8","454fa982.d880d8"]]},{"id":"45312be0.e19094","type":"split","z":"b14d8661.cf75a8","name":"split","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":270,"y":200,"wires":[["875ad719.a08528"]]},{"id":"875ad719.a08528","type":"switch","z":"b14d8661.cf75a8","name":"if else","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"gaia.blockstack.org","vt":"str"},{"t":"nnull"}],"checkall":"true","repair":false,"outputs":2,"x":270,"y":260,"wires":[["1c52fce5.c262c3"],["f2f8a56c.372fa8"]]},{"id":"f2f8a56c.372fa8","type":"debug","z":"b14d8661.cf75a8","name":"trash","active":true,"console":"false","complete":"payload","x":390,"y":320,"wires":[]},{"id":"1c52fce5.c262c3","type":"function","z":"b14d8661.cf75a8","name":"step1","func":"var rawstring = msg.payload;\n\nvar step1 = rawstring.split('gaia.blockstack.org/hub/')\n\nvar cleanedup = step1;\n\nmsg.payload = cleanedup;\nreturn msg;","outputs":1,"noerr":0,"x":410,"y":240,"wires":[["634b97ac.e24738"]]},{"id":"634b97ac.e24738","type":"function","z":"b14d8661.cf75a8","name":"step2","func":"var rawstring = msg.payload[1];\n\nvar cleanedup = rawstring.substring(0, rawstring.length-1);\n\nmsg.headers = {};\nmsg.url = \"https://gaia.blockstack.org/hub/\" + cleanedup;\n\nreturn msg;","outputs":1,"noerr":0,"x":530,"y":240,"wires":[["6bff35be.fe28ec"]]},{"id":"8e25f836.a00a38","type":"ui_template","z":"b14d8661.cf75a8","group":"c986165f.9bf6e8","name":"Expiration Info","order":3,"width":"8","height":"5","format":"<span class=\"md-subhead\">Expiration Block: {{msg.expire}}</span>\n<span class=\"md-subhead\">Current Block: {{msg.height}}</span>\n<span class=\"md-subhead\">Blocks Remaining: {{msg.dif}}</span>\n<p></p>\n<p>Current minutes between Blocks: {{msg.stm}}</p>\n<p>Blocks per day estimate: {{msg.bpd}}</p>\n<p>Estimated Days until Expiration: {{msg.dux}}</p>\n<p>Estimated Date of Expiration: </p>\n<p>Today is: {{msg.now}}</p>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":780,"y":100,"wires":[[]]},{"id":"2436b076.f0367","type":"function","z":"b14d8661.cf75a8","name":"calc block stats","func":"//blockchain length stats\nvar rawheight = global.get(\"blockheight\");\nvar rawexpire = msg.payload.expire_block;\n\n\n//blockchain timing stats\nvar rawintvl = global.get(\"blockinterval\");\nvar intvl = Number(rawintvl);\nvar rawdate = global.get(\"now\");\nvar now1 = Date(rawdate);\n\n//length difference\nvar hght = parseInt(rawheight);\nvar expr = parseInt(rawexpire);\nvar dif = expr - hght;\n\n//timing speculation\nvar stm = intvl / 60; //seconds to minutes, ie 1 block per this minute value\nvar bph = 60 / stm; //blocks per hours estimate\nvar bpd = bph * 24; //hours to days\nvar dux = dif / bpd; // days until expire\nvar mill = dux * 86400000; //days to milliseconds\n\nvar raweta = rawdate + mill.round;\nvar eta = Date(raweta);\n\n\n//pass along the outputs\nmsg.intvl = intvl;\nmsg.stm = stm;\nmsg.bph = bph;\nmsg.bpd = bpd;\nmsg.dux = dux;\nmsg.dif = dif;\nmsg.height = hght;\nmsg.expire = expr;\nmsg.now = now1;\nmsg.rawdate = rawdate;\nmsg.raweta = raweta;\nmsg.eta = eta;\nmsg.mill = mill;\n\nreturn msg;","outputs":1,"noerr":0,"x":560,"y":100,"wires":[["8e25f836.a00a38","55b29b6f.e4eee4"]]},{"id":"d5d09a3c.7502f8","type":"ui_template","z":"b14d8661.cf75a8","group":"67cf68d0.b19928","name":"BTC Address","order":1,"width":"8","height":"1","format":"<a href=\"bitcoin:{{msg.payload[0].decodedToken.payload.claim.account[0].identifier}}\">{{msg.payload[0].decodedToken.payload.claim.account[0].identifier}}</a>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":1050,"y":240,"wires":[[]]},{"id":"2f163f25.b60ba","type":"http request","z":"b14d8661.cf75a8","name":"get name","method":"GET","ret":"txt","url":"http://localhost:9877/get_username","tls":"","x":220,"y":20,"wires":[["3ca57739.6241f8","9d569c14.93afb"]]},{"id":"a10d05c7.ee0608","type":"ui_template","z":"b14d8661.cf75a8","group":"67cf68d0.b19928","name":"BTC Balance","order":2,"width":"0","height":"0","format":"Current Balance: {{msg.payload}} (Satoshi)","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":1270,"y":200,"wires":[[]]},{"id":"4ab3d838.8ffdf8","type":"http request","z":"b14d8661.cf75a8","name":"get balance","method":"GET","ret":"txt","url":"","tls":"","x":1210,"y":160,"wires":[["a10d05c7.ee0608"]]},{"id":"454fa982.d880d8","type":"function","z":"b14d8661.cf75a8","name":"build url","func":"var btc = msg.payload[0].decodedToken.payload.claim.account[0].identifier;\n\nmsg.url = \"https://blockchain.info/q/addressbalance/\" + btc + \"?confirmations=6\";\nreturn msg;","outputs":1,"noerr":0,"x":1060,"y":160,"wires":[["4ab3d838.8ffdf8"]]},{"id":"4a6a242f.d7620c","type":"inject","z":"36c46629.c8f23a","name":"request every 1min","topic":"","payload":"","payloadType":"date","repeat":"60","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":20,"wires":[["2a0555a1.5d0d3a"]]},{"id":"90aa9d60.cf482","type":"function","z":"36c46629.c8f23a","name":"set blockheight","func":"global.set(\"blockheight\",msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":560,"y":20,"wires":[["9ab514f6.5b8b78"]]},{"id":"2a0555a1.5d0d3a","type":"http request","z":"36c46629.c8f23a","name":"get current block number","method":"GET","ret":"txt","url":"https://blockchain.info/q/getblockcount","tls":"","x":350,"y":20,"wires":[["90aa9d60.cf482"]]},{"id":"9ab514f6.5b8b78","type":"debug","z":"36c46629.c8f23a","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":750,"y":20,"wires":[]},{"id":"791bde0e.ab185","type":"inject","z":"36c46629.c8f23a","name":"request every 1min","topic":"","payload":"","payloadType":"date","repeat":"60","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":120,"wires":[["ee41c774.988ac8"]]},{"id":"a904a752.5d4a88","type":"function","z":"36c46629.c8f23a","name":"set blockinterval","func":"global.set(\"blockinterval\",msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":560,"y":120,"wires":[["4631cbf6.36e8b4"]]},{"id":"ee41c774.988ac8","type":"http request","z":"36c46629.c8f23a","name":"get current block interval","method":"GET","ret":"txt","url":"https://blockchain.info/q/interval","tls":"","x":350,"y":120,"wires":[["a904a752.5d4a88"]]},{"id":"4631cbf6.36e8b4","type":"debug","z":"36c46629.c8f23a","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":750,"y":120,"wires":[]},{"id":"686c3b37.4ce2a4","type":"http in","z":"1cff0692.475319","name":"","url":"/searchid","method":"get","upload":false,"swaggerDoc":"","x":70,"y":100,"wires":[["35c1d6ab.a3d12a"]]},{"id":"6764f3c1.94cd2c","type":"http in","z":"1cff0692.475319","name":"","url":"/searchidpost","method":"post","upload":false,"swaggerDoc":"","x":100,"y":300,"wires":[["295dc8ad.40fb78","e6fa5d43.c176f","4b62ab5c.b56854"]]},{"id":"35c1d6ab.a3d12a","type":"function","z":"1cff0692.475319","name":"msg.url = \"searchidpost\";","func":"msg.url = \"searchidpost\";\nreturn msg;","outputs":1,"noerr":0,"x":290,"y":100,"wires":[["6785ee2f.71d16"]]},{"id":"295dc8ad.40fb78","type":"debug","z":"1cff0692.475319","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":330,"y":240,"wires":[]},{"id":"11ce9a3d.783076","type":"http response","z":"1cff0692.475319","name":"","x":710,"y":300,"wires":[]},{"id":"7da35aa0.7aecc4","type":"template","z":"1cff0692.475319","name":"CSS","field":"payload.style","fieldType":"msg","format":"html","syntax":"mustache","template":"input[type=text], select {\n    width: 100%;\n    padding: 12px 20px;\n    margin: 8px 0;\n    display: inline-block;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n}\n\ninput[type=submit] {\n    width: 100%;\n    background-color: #7e097d;\n    color: white;\n    padding: 14px 20px;\n    margin: 8px 0;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n}\n\ninput[type=submit]:hover {\n    background-color: #b337b2;\n}\n\ndiv {\n    border-radius: 5px;\n    background-color: #fff;\n    padding: 20px;\n}","x":630,"y":100,"wires":[["1a6389eb.7e32a6"]]},{"id":"6785ee2f.71d16","type":"template","z":"1cff0692.475319","name":"JavaScript","field":"payload.script","fieldType":"msg","format":"javascript","syntax":"plain","template":"$(document).ready(function(e) {\n    \n    $(\"form[ajax=true]\").submit(function(e) {\n        \n        e.preventDefault();\n        \n        var form_data = $(this).serialize();\n        var form_url = $(this).attr(\"action\");\n        var form_method = $(this).attr(\"method\").toUpperCase();\n        \n        $(\"#loadingimg\").show();\n        \n        $.ajax({\n            url: form_url, \n            type: form_method,      \n            data: form_data,     \n            cache: false,\n            success: function(returnhtml){                          \n                $(\"#result\").html(returnhtml); \n                $(\"#loadingimg\").hide();                    \n            }           \n        });    \n        \n    });\n    \n});","x":490,"y":100,"wires":[["7da35aa0.7aecc4"]]},{"id":"9658972a.611568","type":"http response","z":"1cff0692.475319","name":"","x":890,"y":100,"wires":[]},{"id":"1a6389eb.7e32a6","type":"template","z":"1cff0692.475319","name":"HTML","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<html>\n  <head>\n    <meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\">\n    <meta charset=\"utf-8\">\n    <script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script>\n    <style>{{{payload.style}}}</style>\n  </head>\n\n<div>\n  <form method=\"post\" action=\"/{{url}}\" ajax=\"true\">\n    <label for=\"name\">Find Name by its registered .ID</label>\n    <input type=\"text\" id=\"name\" name=\"name\" placeholder=\"ryanshea.id\">\n\n    <input type=\"submit\" value=\"Search\">\n  </form>\n</div>\n<div>\n    <span id=\"result\"></span>\n</div>\n\n</body>\n</html>\n<script>{{{payload.script}}}</script>","x":750,"y":100,"wires":[["9658972a.611568"]]},{"id":"e8c29a0.646a868","type":"function","z":"1cff0692.475319","name":"return msg.payload to client","func":"msg.payload = 'The following data was submitted and available in the msg.payload: '+msg.payload;\n\nreturn msg;","outputs":1,"noerr":0,"x":520,"y":300,"wires":[["11ce9a3d.783076"]]},{"id":"e6fa5d43.c176f","type":"json","z":"1cff0692.475319","name":"","x":310,"y":300,"wires":[["e8c29a0.646a868","2148bf69.b0821"]]},{"id":"d45e6f16.11e61","type":"comment","z":"1cff0692.475319","name":"GET the Form","info":"","x":70,"y":20,"wires":[]},{"id":"fadff021.2e4b","type":"comment","z":"1cff0692.475319","name":"POST the Form","info":"","x":80,"y":240,"wires":[]},{"id":"446a8bcb.6f1734","type":"ui_ui_control","z":"1cff0692.475319","name":"ui control","x":560,"y":420,"wires":[[]]},{"id":"4b62ab5c.b56854","type":"function","z":"1cff0692.475319","name":"redirect to Results tab","func":"msg.payload = \"ID Results\";\nreturn msg;","outputs":1,"noerr":0,"x":320,"y":420,"wires":[["446a8bcb.6f1734"]]},{"id":"2148bf69.b0821","type":"link out","z":"1cff0692.475319","name":"search by ID output","links":["f2cf0970.304628"],"x":415,"y":360,"wires":[]},{"id":"4a0d9ae8.24d0a4","type":"http in","z":"6749a743.2cf198","name":"","url":"/searchproject","method":"get","upload":false,"swaggerDoc":"","x":90,"y":100,"wires":[["7d417cec.53a864"]]},{"id":"b38b9706.f659d8","type":"http in","z":"6749a743.2cf198","name":"","url":"/searchprojectpost","method":"post","upload":false,"swaggerDoc":"","x":120,"y":300,"wires":[["c8344e06.165b6","bbdb9eee.fb87c","757bae4a.26154"]]},{"id":"7d417cec.53a864","type":"function","z":"6749a743.2cf198","name":"msg.url = \"searchprojectpost\";","func":"msg.url = \"searchprojectpost\";\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":100,"wires":[["d91f49a3.bf46c8"]]},{"id":"c8344e06.165b6","type":"debug","z":"6749a743.2cf198","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":330,"y":240,"wires":[]},{"id":"f3601093.10e7e","type":"http response","z":"6749a743.2cf198","name":"","x":710,"y":300,"wires":[]},{"id":"df96b951.148f58","type":"template","z":"6749a743.2cf198","name":"CSS","field":"payload.style","fieldType":"msg","format":"html","syntax":"mustache","template":"input[type=text], select {\n    width: 100%;\n    padding: 12px 20px;\n    margin: 8px 0;\n    display: inline-block;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n}\n\ninput[type=submit] {\n    width: 100%;\n    background-color: #7e097d;\n    color: white;\n    padding: 14px 20px;\n    margin: 8px 0;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n}\n\ninput[type=submit]:hover {\n    background-color: #b337b2;\n}\n\ndiv {\n    border-radius: 5px;\n    background-color: #fff;\n    padding: 20px;\n}","x":710,"y":100,"wires":[["48ffc7a1.b2f058"]]},{"id":"d91f49a3.bf46c8","type":"template","z":"6749a743.2cf198","name":"JavaScript","field":"payload.script","fieldType":"msg","format":"javascript","syntax":"plain","template":"$(document).ready(function(e) {\n    \n    $(\"form[ajax=true]\").submit(function(e) {\n        \n        e.preventDefault();\n        \n        var form_data = $(this).serialize();\n        var form_url = $(this).attr(\"action\");\n        var form_method = $(this).attr(\"method\").toUpperCase();\n        \n        $(\"#loadingimg\").show();\n        \n        $.ajax({\n            url: form_url, \n            type: form_method,      \n            data: form_data,     \n            cache: false,\n            success: function(returnhtml){                          \n                $(\"#result\").html(returnhtml); \n                $(\"#loadingimg\").hide();                    \n            }           \n        });    \n        \n    });\n    \n});","x":570,"y":100,"wires":[["df96b951.148f58"]]},{"id":"f4141418.3b09a8","type":"http response","z":"6749a743.2cf198","name":"","x":970,"y":100,"wires":[]},{"id":"48ffc7a1.b2f058","type":"template","z":"6749a743.2cf198","name":"HTML","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<html>\n  <head>\n    <meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\">\n    <meta charset=\"utf-8\">\n    <script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script>\n    <style>{{{payload.style}}}</style>\n  </head>\n\n<div>\n  <form method=\"post\" action=\"/{{url}}\" ajax=\"true\">\n    <label for=\"name\">Find Project by its registered .ID</label>\n    <input type=\"text\" id=\"name\" name=\"name\" placeholder=\"pr01-33u8oz9a3n5wu6pomej9s39r.id\">\n\n    <input type=\"submit\" value=\"Search\">\n  </form>\n</div>\n<div>\n    <span id=\"result\"></span>\n</div>\n\n</body>\n</html>\n<script>{{{payload.script}}}</script>","x":830,"y":100,"wires":[["f4141418.3b09a8"]]},{"id":"7fd7ac58.ab6824","type":"function","z":"6749a743.2cf198","name":"return msg.payload to client","func":"msg.payload = 'The following data was submitted and available in the msg.payload: '+msg.payload;\n\nreturn msg;","outputs":1,"noerr":0,"x":520,"y":300,"wires":[["f3601093.10e7e"]]},{"id":"bbdb9eee.fb87c","type":"json","z":"6749a743.2cf198","name":"","x":310,"y":300,"wires":[["7fd7ac58.ab6824","a77bf0f5.e6348"]]},{"id":"56d304d3.5ee71c","type":"comment","z":"6749a743.2cf198","name":"GET the Form","info":"","x":70,"y":20,"wires":[]},{"id":"f80da9b8.b9f428","type":"comment","z":"6749a743.2cf198","name":"POST the Form","info":"","x":80,"y":240,"wires":[]},{"id":"50603e9a.39f7f","type":"ui_ui_control","z":"6749a743.2cf198","name":"ui control","x":620,"y":420,"wires":[[]]},{"id":"757bae4a.26154","type":"function","z":"6749a743.2cf198","name":"redirect to appropriate ui tab","func":"msg.payload = \"Project Results\";\nreturn msg;","outputs":1,"noerr":0,"x":400,"y":420,"wires":[["50603e9a.39f7f"]]},{"id":"a77bf0f5.e6348","type":"link out","z":"6749a743.2cf198","name":"search by ID output","links":["3100a701.d01b58","f2cf0970.304628","1ea18088.46eabf"],"x":475,"y":360,"wires":[]},{"id":"f2cf0970.304628","type":"link in","z":"1cff0692.475319","name":"search by ID input","links":["2148bf69.b0821","a77bf0f5.e6348"],"x":35,"y":660,"wires":[["8aa47391.d60cc"]]},{"id":"52c8c5ab.7484ac","type":"debug","z":"1cff0692.475319","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":330,"y":660,"wires":[]},{"id":"35922dad.d04392","type":"http request","z":"1cff0692.475319","name":"get from blockstack","method":"GET","ret":"txt","url":"https://core.blockstack.org/v1/names/{{payload}}","tls":"","x":170,"y":780,"wires":[["b35ecef4.5a945"]]},{"id":"b35ecef4.5a945","type":"json","z":"1cff0692.475319","name":"","pretty":false,"x":350,"y":780,"wires":[["f2f19b04.45d668","b31bb061.79448"]]},{"id":"f2f19b04.45d668","type":"function","z":"1cff0692.475319","name":"rebind zonefile","func":"var raw_zone = msg.payload.zonefile;\n\nmsg.payload = raw_zone;\n\nreturn msg;","outputs":1,"noerr":0,"x":160,"y":860,"wires":[["49cd57b4.e0f208"]]},{"id":"49cd57b4.e0f208","type":"split","z":"1cff0692.475319","name":"split","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":330,"y":860,"wires":[["f49c0f3c.bde5e"]]},{"id":"f49c0f3c.bde5e","type":"switch","z":"1cff0692.475319","name":"if else","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"gaia.blockstack.org","vt":"str"},{"t":"nnull"}],"checkall":"true","repair":false,"outputs":2,"x":270,"y":920,"wires":[["21604ce8.116e34"],["3656db13.eb1024"]]},{"id":"21604ce8.116e34","type":"function","z":"1cff0692.475319","name":"step1","func":"var rawstring = msg.payload;\n\nvar step1 = rawstring.split('gaia.blockstack.org/hub/')\n\nvar cleanedup = step1;\n\nmsg.payload = cleanedup;\nreturn msg;","outputs":1,"noerr":0,"x":410,"y":920,"wires":[["31b777cf.fb51c8"]]},{"id":"3656db13.eb1024","type":"debug","z":"1cff0692.475319","name":"trash","active":true,"console":"false","complete":"payload","x":390,"y":1000,"wires":[]},{"id":"31b777cf.fb51c8","type":"function","z":"1cff0692.475319","name":"step2","func":"var rawstring = msg.payload[1];\n\nvar cleanedup = rawstring.substring(0, rawstring.length-1);\n\nmsg.headers = {};\nmsg.url = \"https://gaia.blockstack.org/hub/\" + cleanedup;\n\nreturn msg;","outputs":1,"noerr":0,"x":530,"y":920,"wires":[["783b8b0e.43c024"]]},{"id":"783b8b0e.43c024","type":"http request","z":"1cff0692.475319","name":"get from gaia","method":"GET","ret":"txt","url":"","tls":"","x":670,"y":920,"wires":[["f991ea5e.7a5108","97bc1580.7357a8"]]},{"id":"f991ea5e.7a5108","type":"json","z":"1cff0692.475319","name":"","pretty":false,"x":730,"y":980,"wires":[["74ff7c5c.bb05f4","55c43c2f.ee8f34"]]},{"id":"420adc7e.9ba514","type":"function","z":"1cff0692.475319","name":"build url","func":"var btc = msg.payload;\n\nmsg.url = \"https://blockchain.info/q/addressbalance/\" + btc + \"?confirmations=6\";\nreturn msg;","outputs":1,"noerr":0,"x":1120,"y":880,"wires":[["e3e597d3.1cd028"]]},{"id":"e3e597d3.1cd028","type":"http request","z":"1cff0692.475319","name":"get balance","method":"GET","ret":"txt","url":"","tls":"","x":1290,"y":880,"wires":[["5e51418e.b99fa"]]},{"id":"b31bb061.79448","type":"function","z":"1cff0692.475319","name":"calc block stats","func":"//blockchain length stats\nvar rawheight = global.get(\"blockheight\");\nvar rawexpire = msg.payload.expire_block;\n\n\n//blockchain timing stats\nvar rawintvl = global.get(\"blockinterval\");\nvar intvl = Number(rawintvl);\nvar rawdate = global.get(\"now\");\nvar now1 = Date(rawdate);\n\n//length difference\nvar hght = parseInt(rawheight);\nvar expr = parseInt(rawexpire);\nvar dif = expr - hght;\n\n//timing speculation\nvar stm = intvl / 60; //seconds to minutes, ie 1 block per this minute value\nvar bph = 60 / stm; //blocks per hours estimate\nvar bpd = bph * 24; //hours to days\nvar dux = dif / bpd; // days until expire\nvar mill = dux * 86400000; //days to milliseconds\n\nvar raweta = rawdate + mill.round;\nvar eta = Date(raweta);\n\n\n//pass along the outputs\nmsg.intvl = intvl;\nmsg.stm = stm;\nmsg.bph = bph;\nmsg.bpd = bpd;\nmsg.dux = dux;\nmsg.dif = dif;\nmsg.height = hght;\nmsg.expire = expr;\nmsg.now = now1;\nmsg.rawdate = rawdate;\nmsg.raweta = raweta;\nmsg.eta = eta;\nmsg.mill = mill;\n\nreturn msg;","outputs":1,"noerr":0,"x":560,"y":780,"wires":[["7b0e1af9.aa1e74"]]},{"id":"8aa47391.d60cc","type":"json","z":"1cff0692.475319","name":"","property":"payload","action":"","pretty":false,"x":130,"y":660,"wires":[["52c8c5ab.7484ac","530b04f1.ea1d9c"]]},{"id":"530b04f1.ea1d9c","type":"function","z":"1cff0692.475319","name":"adjust prop","func":"var idname = msg.payload.name;\n\nmsg.payload = idname;\nreturn msg;","outputs":1,"noerr":0,"x":150,"y":720,"wires":[["35922dad.d04392"]]},{"id":"74ff7c5c.bb05f4","type":"ui_template","z":"1cff0692.475319","group":"c245c49a.425238","name":"Result","order":1,"width":"8","height":"7","format":"<md-card md-theme=\"\" md-theme-watch>\n<md-card-title>\n    <md-card-title-text>\n        <span class=\"md-headline\">{{msg.payload[0].decodedToken.payload.claim.name}}</span>\n    </md-card-title-text>\n</md-card-title>\n<md-card-content layout=\"row\" layout-align=\"space-between\">\n<div class=\"md-media-xl card-media\">\n   <img src=\"{{msg.payload[0].decodedToken.payload.claim.image[0].contentUrl}}\" alt=\"{{msg.payload[0].decodedToken.payload.claim.name}}\" width=\"180\" height=\"180\">\n    <md-card-title-text>\n        <p></p>\n        <span class=\"md-subhead\">{{msg.payload[0].decodedToken.payload.claim.description}}</span>\n    </md-card-title-text>\n</div>\n<md-card-actions layout=\"column\">\n<md-button class=\"fa fa-link fa-2x\" ng-href=\"{{msg.payload[0].decodedToken.payload.claim.account[0].proofUrl}}\" target=\"_blank\" aria-label=\"1st Proof\">\n  <md-icon ></md-icon>1st\n</md-button>\n<md-button class=\"fa fa-link fa-2x\" ng-href=\"{{msg.payload[0].decodedToken.payload.claim.account[1].proofUrl}}\" target=\"_blank\" aria-label=\"2nd Proof\">\n  <md-icon ></md-icon>2nd\n</md-button>\n\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":910,"y":980,"wires":[[]]},{"id":"7b0e1af9.aa1e74","type":"ui_template","z":"1cff0692.475319","group":"c245c49a.425238","name":"Expiration Info","order":3,"width":"8","height":"5","format":"<span class=\"md-subhead\">Expiration Block: {{msg.expire}}</span>\n<span class=\"md-subhead\">Current Block: {{msg.height}}</span>\n<span class=\"md-subhead\">Blocks Remaining: {{msg.dif}}</span>\n<p></p>\n<p>Current minutes between Blocks: {{msg.stm}}</p>\n<p>Blocks per day estimate: {{msg.bpd}}</p>\n<p>Estimated Days until Expiration: {{msg.dux}}</p>\n<p>Estimated Date of Expiration: </p>\n<p>Today is: {{msg.now}}</p>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":780,"y":780,"wires":[[]]},{"id":"97bc1580.7357a8","type":"function","z":"1cff0692.475319","name":"isolate BTC address","func":"var string1 = msg.payload;\n\nvar step1 = string1.split('service\\\": \\\"bitcoin\\\",')[1];\nvar step2 = step1.split('\\\"identifier\\\": \\\"')[1];\nvar step3 = step2.substring(0,34);\n\nmsg.payload = step3;\nreturn msg;","outputs":1,"noerr":0,"x":880,"y":880,"wires":[["420adc7e.9ba514","5e51418e.b99fa","29439a2.5048966","4cf30d43.edddd4","e32588da.36ec88"]]},{"id":"55c43c2f.ee8f34","type":"debug","z":"1cff0692.475319","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":870,"y":1020,"wires":[]},{"id":"4530914d.4dc1a","type":"comment","z":"1cff0692.475319","name":"SEARCH RESULTS","info":"","x":90,"y":620,"wires":[]},{"id":"4cafb9f9.d45768","type":"comment","z":"6749a743.2cf198","name":"Search Results","info":"","x":80,"y":680,"wires":[]},{"id":"2b5d97bc.94e448","type":"json","z":"6749a743.2cf198","name":"","property":"payload","action":"","pretty":false,"x":110,"y":760,"wires":[["e8ea660a.b3a728","42975b73.875dd4"]]},{"id":"1ea18088.46eabf","type":"link in","z":"6749a743.2cf198","name":"search by ID input","links":["a77bf0f5.e6348"],"x":15,"y":760,"wires":[["2b5d97bc.94e448"]]},{"id":"e8ea660a.b3a728","type":"debug","z":"6749a743.2cf198","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":310,"y":760,"wires":[]},{"id":"42975b73.875dd4","type":"function","z":"6749a743.2cf198","name":"adjust prop","func":"var idname = msg.payload.name;\n\nmsg.payload = idname;\nreturn msg;","outputs":1,"noerr":0,"x":130,"y":820,"wires":[["515d980b.8a4288","c1a5235e.ebdf1"]]},{"id":"515d980b.8a4288","type":"http request","z":"6749a743.2cf198","name":"get from blockstack","method":"GET","ret":"txt","url":"https://core.blockstack.org/v1/names/{{payload}}","tls":"","x":150,"y":880,"wires":[["439ec36b.0023dc"]]},{"id":"c1a5235e.ebdf1","type":"ui_template","z":"6749a743.2cf198","group":"a266c3f6.4664","name":"","order":0,"width":0,"height":0,"format":"<div ng-bind-html=\"msg.payload\"></div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":400,"y":820,"wires":[[]]},{"id":"439ec36b.0023dc","type":"json","z":"6749a743.2cf198","name":"","pretty":false,"x":330,"y":880,"wires":[["b946528e.824fe","a9cd2698.21d588"]]},{"id":"b946528e.824fe","type":"function","z":"6749a743.2cf198","name":"rebind zonefile","func":"var raw_zone = msg.payload.zonefile;\n\nmsg.payload = raw_zone;\n\nreturn msg;","outputs":1,"noerr":0,"x":140,"y":960,"wires":[["f7cdbcc4.ae1d2","7038489.1efadb8"]]},{"id":"a9cd2698.21d588","type":"function","z":"6749a743.2cf198","name":"calc block stats","func":"//blockchain length stats\nvar rawheight = global.get(\"blockheight\");\nvar rawexpire = msg.payload.expire_block;\n\n\n//blockchain timing stats\nvar rawintvl = global.get(\"blockinterval\");\nvar intvl = Number(rawintvl);\nvar rawdate = global.get(\"now\");\nvar now1 = Date(rawdate);\n\n//length difference\nvar hght = parseInt(rawheight);\nvar expr = parseInt(rawexpire);\nvar dif = expr - hght;\n\n//timing speculation\nvar stm = intvl / 60; //seconds to minutes, ie 1 block per this minute value\nvar bph = 60 / stm; //blocks per hours estimate\nvar bpd = bph * 24; //hours to days\nvar dux = dif / bpd; // days until expire\nvar mill = dux * 86400000; //days to milliseconds\n\nvar raweta = rawdate + mill.round;\nvar eta = Date(raweta);\n\n\n//pass along the outputs\nmsg.intvl = intvl;\nmsg.stm = stm;\nmsg.bph = bph;\nmsg.bpd = bpd;\nmsg.dux = dux;\nmsg.dif = dif;\nmsg.height = hght;\nmsg.expire = expr;\nmsg.now = now1;\nmsg.rawdate = rawdate;\nmsg.raweta = raweta;\nmsg.eta = eta;\nmsg.mill = mill;\n\nreturn msg;","outputs":1,"noerr":0,"x":540,"y":880,"wires":[["66f65fca.22d06"]]},{"id":"f3a9fc00.ba19f","type":"split","z":"6749a743.2cf198","name":"split","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":250,"y":1060,"wires":[["e12ddd28.8df6f"]]},{"id":"66f65fca.22d06","type":"ui_template","z":"6749a743.2cf198","group":"a266c3f6.4664","name":"Expiration Info","order":3,"width":"8","height":"5","format":"<span class=\"md-subhead\">Expiration Block: {{msg.expire}}</span>\n<span class=\"md-subhead\">Current Block: {{msg.height}}</span>\n<span class=\"md-subhead\">Blocks Remaining: {{msg.dif}}</span>\n<p></p>\n<p>Current minutes between Blocks: {{msg.stm}}</p>\n<p>Blocks per day estimate: {{msg.bpd}}</p>\n<p>Estimated Days until Expiration: {{msg.dux}}</p>\n<p>Estimated Date of Expiration: </p>\n<p>Today is: {{msg.now}}</p>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":760,"y":880,"wires":[[]]},{"id":"e12ddd28.8df6f","type":"switch","z":"6749a743.2cf198","name":"if else","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"gaia.blockstack.org","vt":"str"},{"t":"nnull"}],"checkall":"true","repair":false,"outputs":2,"x":250,"y":1100,"wires":[["4dcb59de.81af58"],["c01c6b8c.8e8a28"]]},{"id":"4dcb59de.81af58","type":"function","z":"6749a743.2cf198","name":"step1","func":"var rawstring = msg.payload;\n\nvar step1 = rawstring.split('gaia.blockstack.org/hub/')\n\nvar cleanedup = step1;\n\nmsg.payload = cleanedup;\nreturn msg;","outputs":1,"noerr":0,"x":390,"y":1100,"wires":[["d3e4632c.7deee"]]},{"id":"c01c6b8c.8e8a28","type":"debug","z":"6749a743.2cf198","name":"trash","active":true,"console":"false","complete":"payload","x":370,"y":1180,"wires":[]},{"id":"d3e4632c.7deee","type":"function","z":"6749a743.2cf198","name":"step2","func":"var rawstring = msg.payload[1];\n\nvar cleanedup = rawstring.substring(0, rawstring.length-1);\n\nmsg.headers = {};\nmsg.url = \"https://gaia.blockstack.org/hub/\" + cleanedup;\n\nreturn msg;","outputs":1,"noerr":0,"x":510,"y":1100,"wires":[["2576349f.67d70c"]]},{"id":"2576349f.67d70c","type":"http request","z":"6749a743.2cf198","name":"get from gaia","method":"GET","ret":"txt","url":"","tls":"","x":650,"y":1100,"wires":[["60471e.34ea18e4"]]},{"id":"60471e.34ea18e4","type":"json","z":"6749a743.2cf198","name":"","pretty":false,"x":790,"y":1100,"wires":[[]]},{"id":"7038489.1efadb8","type":"ui_template","z":"6749a743.2cf198","group":"a266c3f6.4664","name":"Result","order":1,"width":"8","height":"7","format":"zonefile: {{msg.payload}}","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":330,"y":1000,"wires":[[]]},{"id":"64c44bad.a90434","type":"debug","z":"6749a743.2cf198","name":"debug project zonefile","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":540,"y":960,"wires":[]},{"id":"f7cdbcc4.ae1d2","type":"json","z":"6749a743.2cf198","name":"","property":"payload","action":"","pretty":false,"x":330,"y":960,"wires":[["64c44bad.a90434"]]},{"id":"5e51418e.b99fa","type":"debug","z":"1cff0692.475319","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":1330,"y":780,"wires":[]},{"id":"29439a2.5048966","type":"ui_template","z":"1cff0692.475319","group":"c245c49a.425238","name":"Bitcoin Address Link","order":2,"width":0,"height":0,"format":"<div>\n    <a href=\"bitcoin:{{msg.payload}}\">{{msg.payload}}</a>\n</div>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":1300,"y":1000,"wires":[[]]},{"id":"4cf30d43.edddd4","type":"ui_template","z":"1cff0692.475319","group":"c245c49a.425238","name":"BTCQR","order":2,"width":0,"height":0,"format":"<div>\n    <img src=\"https://blockchain.info/qr?data={{msg.payload}}&size=125\" alt=\"QR\" height=\"125\" width=\"125\">\n</div>\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":1220,"y":1100,"wires":[[]]},{"id":"137679f0.ebcfb6","type":"ui_ui_control","z":"1cff0692.475319","name":"","x":1280,"y":1200,"wires":[[]]},{"id":"e32588da.36ec88","type":"function","z":"1cff0692.475319","name":"show qr code","func":"\nreturn msg;","outputs":1,"noerr":0,"x":1090,"y":1200,"wires":[["137679f0.ebcfb6"]]},{"id":"51bd82c2.e6bcdc","type":"http in","z":"c13afb34.e0d258","name":"","url":"/savedata","method":"get","upload":false,"swaggerDoc":"","x":80,"y":100,"wires":[["4b8a3d4f.5e1464"]]},{"id":"c0c7876e.014028","type":"http in","z":"c13afb34.e0d258","name":"","url":"/savedatapost","method":"post","upload":false,"swaggerDoc":"","x":90,"y":280,"wires":[["a493b3b4.90646","84a472cc.93b34","d04dbd96.0aa53"]]},{"id":"4b8a3d4f.5e1464","type":"function","z":"c13afb34.e0d258","name":"msg.url = \"savedatapost\";","func":"msg.url = \"savedatapost\";\nreturn msg;","outputs":1,"noerr":0,"x":310,"y":100,"wires":[["ff1150aa.82557"]]},{"id":"a493b3b4.90646","type":"debug","z":"c13afb34.e0d258","name":"mysitepost","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":330,"y":240,"wires":[]},{"id":"7f7ed726.d4a1f8","type":"http response","z":"c13afb34.e0d258","name":"","x":810,"y":280,"wires":[]},{"id":"2c12755c.03191a","type":"template","z":"c13afb34.e0d258","name":"CSS","field":"payload.style","fieldType":"msg","format":"html","syntax":"mustache","template":"input[type=text], select {\n    width: 100%;\n    padding: 12px 20px;\n    margin: 8px 0;\n    display: inline-block;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n}\n\ninput[type=submit] {\n    width: 100%;\n    background-color: #7e097d;\n    color: white;\n    padding: 14px 20px;\n    margin: 8px 0;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n}\n\ninput[type=submit]:hover {\n    background-color: #b337b2;\n}\n\ndiv {\n    border-radius: 5px;\n    background-color: #fff;\n    padding: 20px;\n}","x":710,"y":100,"wires":[["e5375497.c46728"]]},{"id":"ff1150aa.82557","type":"template","z":"c13afb34.e0d258","name":"JavaScript","field":"payload.script","fieldType":"msg","format":"javascript","syntax":"plain","template":"$(document).ready(function(e) {\n    \n    $(\"form[ajax=true]\").submit(function(e) {\n        \n        e.preventDefault();\n        \n        var form_data = $(this).serialize();\n        var form_url = $(this).attr(\"action\");\n        var form_method = $(this).attr(\"method\").toUpperCase();\n        \n        $(\"#loadingimg\").show();\n        \n        $.ajax({\n            url: form_url, \n            type: form_method,      \n            data: form_data,     \n            cache: false,\n            success: function(returnhtml){                          \n                $(\"#result\").html(returnhtml); \n                $(\"#loadingimg\").hide();                    \n            }           \n        });    \n        \n    });\n    \n});","x":570,"y":100,"wires":[["2c12755c.03191a"]]},{"id":"ad41d64c.23d4e8","type":"http response","z":"c13afb34.e0d258","name":"","x":1010,"y":100,"wires":[]},{"id":"e5375497.c46728","type":"template","z":"c13afb34.e0d258","name":"HTML","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<html>\n  <head>\n    <meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\">\n    <meta charset=\"utf-8\">\n    <script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script>\n    <style>{{{payload.style}}}</style>\n  </head>\n\n<div>\n  <form method=\"post\" action=\"/{{url}}\" ajax=\"true\">\n    <label for=\"todo\">Save your todo</label>\n    <input type=\"text\" id=\"todo\" name=\"todo\" placeholder=\"todo\">\n\n    <input type=\"submit\" value=\"Save\">\n  </form>\n</div>\n<div>\n    <span id=\"result\"></span>\n</div>\n\n</body>\n</html>\n<script>{{{payload.script}}}</script>","x":830,"y":100,"wires":[["ad41d64c.23d4e8"]]},{"id":"11e1c230.1a1b4e","type":"function","z":"c13afb34.e0d258","name":"return msg.payload to client","func":"msg.payload = 'The following todo was encrypted and is available in your dropbox: '+msg.payload;\n\nreturn msg;","outputs":1,"noerr":0,"x":600,"y":280,"wires":[["7f7ed726.d4a1f8"]]},{"id":"84a472cc.93b34","type":"json","z":"c13afb34.e0d258","name":"","x":310,"y":280,"wires":[["11e1c230.1a1b4e","c2775c8e.5b39b"]]},{"id":"8291a9da.ac34e8","type":"comment","z":"c13afb34.e0d258","name":"GET the Form","info":"","x":70,"y":20,"wires":[]},{"id":"5d012736.6695a8","type":"comment","z":"c13afb34.e0d258","name":"POST the Form","info":"","x":80,"y":240,"wires":[]},{"id":"d04dbd96.0aa53","type":"function","z":"c13afb34.e0d258","name":"redirect to appropriate ui tab","func":"msg.payload = \"Saved Results\";\nreturn msg;","outputs":1,"noerr":0,"x":340,"y":520,"wires":[["32036.25c8ffcae"]]},{"id":"32036.25c8ffcae","type":"ui_ui_control","z":"c13afb34.e0d258","name":"ui control","x":600,"y":520,"wires":[[]]},{"id":"e3e7b8d9.73d5e8","type":"dropbox out","z":"c13afb34.e0d258","dropbox":"1dae6acc.6eaf65","filename":"","localFilename":"","name":"Dropbox","x":780,"y":400,"wires":[]},{"id":"5eae2188.ea315","type":"encrypt","z":"c13afb34.e0d258","name":"Encrypt","algorithm":"AES","key":"123abc","x":320,"y":400,"wires":[["1d332ac1.071645"]]},{"id":"4f3ea19c.12691","type":"debug","z":"c13afb34.e0d258","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":770,"y":440,"wires":[]},{"id":"4432d24d.596c4c","type":"decrypt","z":"c13afb34.e0d258","name":"","algorithm":"AES","key":"123abc","x":420,"y":960,"wires":[["c5b222f0.d28ca","f9578766.cb41e8"]]},{"id":"1d332ac1.071645","type":"function","z":"c13afb34.e0d258","name":"set file name","func":"var data = msg.payload;\nvar now = new Date();\nvar nowUTC = now.getTime();\n\nmsg.filename = nowUTC + \".json\";\nmsg.payload = data;\n\nreturn msg;","outputs":1,"noerr":0,"x":550,"y":400,"wires":[["4f3ea19c.12691","e3e7b8d9.73d5e8"]]},{"id":"56ed936e.a98cdc","type":"dropbox","z":"c13afb34.e0d258","dropbox":"1dae6acc.6eaf65","filename":"","name":"get file","x":250,"y":960,"wires":[["4432d24d.596c4c"]]},{"id":"6bb663ac.2ff5ac","type":"debug","z":"c13afb34.e0d258","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"token","x":990,"y":960,"wires":[]},{"id":"34724dec.beea22","type":"inject","z":"c13afb34.e0d258","name":"inject","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":70,"y":960,"wires":[["56ed936e.a98cdc"]]},{"id":"c2775c8e.5b39b","type":"JsonWebToken","z":"c13afb34.e0d258","name":"JWT","tokenconfig":"7435c557.fc056c","x":310,"y":320,"wires":[["8a2157.0294eea8","d3cb8982.5a1ac8"]]},{"id":"8a2157.0294eea8","type":"debug","z":"c13afb34.e0d258","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":530,"y":320,"wires":[]},{"id":"709b11ee.53a54","type":"JsonWebToken","z":"c13afb34.e0d258","name":"JWT","tokenconfig":"7435c557.fc056c","x":750,"y":960,"wires":[["6bb663ac.2ff5ac"]]},{"id":"d3cb8982.5a1ac8","type":"function","z":"c13afb34.e0d258","name":"rebind","func":"var tkn = msg.token;\nmsg.payload = tkn; \nreturn msg;","outputs":1,"noerr":0,"x":310,"y":360,"wires":[["5eae2188.ea315"]]},{"id":"c5b222f0.d28ca","type":"debug","z":"c13afb34.e0d258","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":590,"y":920,"wires":[]},{"id":"f9578766.cb41e8","type":"function","z":"c13afb34.e0d258","name":"rebind","func":"var tkn = msg.payload;\nmsg.token = tkn; \nreturn msg;","outputs":1,"noerr":0,"x":590,"y":960,"wires":[["709b11ee.53a54"]]},{"id":"562baed.3bf655","type":"comment","z":"c13afb34.e0d258","name":"simple get file and decrypt","info":"the file name needs to be passed into the get node ","x":130,"y":920,"wires":[]},{"id":"840a4792.91f878","type":"http request","z":"c13afb34.e0d258","name":"","method":"GET","ret":"txt","url":"https://gaia.blockstack.org/hub/1CmqZzBHgoeSFq7T8dSCBtFpf9i95XCW1V/1528761610652.json","tls":"","x":310,"y":1180,"wires":[["aec429c9.a3ea28"]]},{"id":"c378d783.19fbf8","type":"inject","z":"c13afb34.e0d258","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":1200,"wires":[["840a4792.91f878"]]},{"id":"7777170c.60fc48","type":"debug","z":"c13afb34.e0d258","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":640,"y":1200,"wires":[]},{"id":"aec429c9.a3ea28","type":"json","z":"c13afb34.e0d258","name":"","property":"payload","action":"","pretty":false,"x":490,"y":1100,"wires":[["7777170c.60fc48"]]}]
